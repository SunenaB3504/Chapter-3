<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lattice Method - Nia's Multiplication Adventure!</title>
    <link rel="stylesheet" href="../css/style.css">
    <!-- Add Favicon Link -->
    <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="90" font-size="90">‚ú®</text></svg>'>
    <style>
        /* Add specific styles for lattice grid if needed later */
        .lattice-grid { border-collapse: collapse; margin: 20px auto; }
        .lattice-grid td {
            border: 1px solid black;
            width: 50px;
            height: 50px;
            position: relative;
            text-align: center;
            font-size: 1.2em;
        }
        .lattice-grid .diagonal {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(to bottom right, transparent 49.5%, black 49.5%, black 50.5%, transparent 50.5%);
            z-index: 1;
        }
         .lattice-grid .num-top { position: absolute; top: 2px; left: 5px; z-index: 2; color: blue; }
         .lattice-grid .num-bottom { position: absolute; bottom: 2px; right: 5px; z-index: 2; color: green; }
         .lattice-grid .outside-num { font-weight: bold; font-size: 1.5em; padding: 10px; }
         .lattice-sum { font-weight: bold; color: red; padding: 5px; }

        /* Styles for Lattice Game */
        .lattice-container {
            margin: 20px auto;
            position: relative;
            width: 240px; /* Adjust size as needed (cell width * 2 + padding/borders) */
            height: 240px;
        }
        .lattice-grid {
            display: grid;
            grid-template-columns: repeat(2, 120px); /* Cell width */
            grid-template-rows: repeat(2, 120px); /* Cell height */
            border: 2px solid black;
            position: relative;
        }
        .lattice-cell {
            border: 1px solid #ccc;
            position: relative;
            background: none;
            display: flex;
            /* Ensure overflow is not hidden */
            /* overflow: hidden; */
        }

        /* Diagonal line using ::before (Top-Right to Bottom-Left) - Adjusted Transform */
        .lattice-cell::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150%; /* Keep extended width */
            height: 1px; /* Line thickness */
            background-color: #aaa; /* Line color */
            transform-origin: 100% 0%; /* Explicitly set origin to top-right corner (X=100%, Y=0%) */
            /* Rotate and slightly adjust X position if needed */
            transform: translateX(0.5px) rotate(135deg); /* Added small positive translateX to nudge slightly right if origin calculation is off */
            z-index: 0; /* Behind inputs */
        }

        /* Cell Input positioning */
        .cell-input-tens {
             position: absolute;
             width: 30px; height: 30px; font-size: 1.2em; text-align: center;
             border: 1px dashed #90caf9; background-color: #e3f2fd; z-index: 1;
             top: 10px; left: 15px; /* Tens in Top-Left triangle */
        }
        .cell-input-ones {
             position: absolute;
             width: 30px; height: 30px; font-size: 1.2em; text-align: center;
             border: 1px dashed #90caf9; background-color: #e3f2fd; z-index: 1;
             bottom: 10px; right: 15px; /* Ones in Bottom-Right triangle */
        }

        .diagonal-sum-input {
            position: absolute;
            width: 40px;
            height: 30px;
            font-size: 1.2em;
            text-align: center;
            border: 1px dashed #ffcdd2;
            background-color: #ffebee;
            z-index: 2; /* Above grid */
        }
        /* Positioning for diagonal sums (adjust precisely) */
        #diag-sum-0 { bottom: -40px; right: -20px; transform: translateX(50%); } /* Bottom right */
        #diag-sum-1 { bottom: -40px; left: 120px; transform: translateX(-50%); }
        #diag-sum-2 { bottom: 0px; left: -40px; transform: translateY(50%); }
        #diag-sum-3 { top: -40px; left: -20px; transform: translateX(-50%); } /* Top left */

        .final-answer-lattice {
            font-size: 1.5em;
            font-weight: bold;
            margin-top: 50px; /* Space below grid */
        }
        .final-answer-lattice input {
            font-size: 1em;
            padding: 5px;
            border: 2px solid #1976d2;
            width: 150px;
            text-align: center;
        }
        .hint-controls button { margin: 0 5px; }
        .hint-area {
            background-color: #fffde7;
            border: 1px dashed #fff59d;
            padding: 10px;
            margin-top: 15px;
            min-height: 40px;
            text-align: left;
        }

        /* Styles for Static Example Grid */
        .static-lattice-container {
            margin: 15px auto;
            position: relative;
            width: 160px; /* Smaller size for example (80px * 2) */
            height: 160px;
            font-family: 'Courier New', Courier, monospace;
        }
        .static-lattice-grid {
            display: grid;
            grid-template-columns: repeat(2, 80px); /* Cell width */
            grid-template-rows: repeat(2, 80px); /* Cell height */
            border: 2px solid black;
            position: relative;
        }
        .static-lattice-cell {
            border: 1px solid #ccc;
            position: relative;
            font-size: 1.2em;
            background: none;
            /* Ensure overflow is not hidden */
            /* overflow: hidden; */
        }

        /* Diagonal line using ::before (Top-Right to Bottom-Left) - Adjusted Transform */
        .static-lattice-cell::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150%; /* Keep extended width */
            height: 1px; /* Line thickness */
            background-color: #aaa; /* Line color */
            transform-origin: 100% 0%; /* Explicitly set origin to top-right corner */
             /* Rotate and slightly adjust X position if needed */
            transform: translateX(0.5px) rotate(135deg); /* Added small positive translateX */
            z-index: 0; /* Behind numbers */
        }

        /* Static Cell Number positioning */
        .static-cell-tens {
             position: absolute; z-index: 1;
             top: 5px; left: 10px; /* Tens in Top-Left triangle */
             color: #666;
        }
        .static-cell-ones {
             position: absolute; z-index: 1;
             bottom: 5px; right: 10px; /* Ones in Bottom-Right triangle */
             color: #000;
        }
        .static-diag-sum {
            position: absolute;
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        /* Positioning for static diagonal sums */
        .static-diag-sum-0 { bottom: -25px; right: -10px; transform: translateX(50%); }
        .static-diag-sum-1 { bottom: -25px; left: 80px; transform: translateX(-50%); } /* Middle bottom */
        .static-diag-sum-2 { bottom: 80px; left: -25px; transform: translateY(50%); } /* Middle left */
        .static-diag-sum-3 { top: -25px; left: -10px; transform: translateX(-50%); }
    </style>
</head>
<body>
    <header>
        <h1>‚ú® Nia's Multiplication Adventure! ‚ú®</h1>
        <!-- Add Score/Reward Display -->
        <div style="text-align: center; color: white; font-size: 1.2em; margin-bottom: 10px;">
            Score: <span id="current-score">0</span> üèÜ | <span id="reward-message"></span>
        </div>
        <nav>
            <ul>
                <li><a href="../index.html">üè† Home</a></li>
                <li><a href="introduction.html">ü§î What is Multiplication?</a></li>
                <li><a href="facts.html">üî¢ Multiplication Facts</a></li>
                <li><a href="properties.html">ü™Ñ Magic Rules (Properties)</a></li>
                <li><a href="tens.html">üîü Multiplying by 10s, 100s, 1000s</a></li>
                <li><a href="2digit.html">‚úñÔ∏è Multiplying Bigger Numbers</a></li>
                <li><a href="lattice.html">Ê†ºÂ≠ê Lattice Method</a></li>
                <li><a href="problems.html">‚úèÔ∏è Practice Problems</a></li>
            </ul>
        </nav>
    </header>

    <main id="content">
        <h2>Ê†ºÂ≠ê Lattice Multiplication (A Different Way to Multiply!) Ê†ºÂ≠ê</h2>
        <p>This method uses a grid to break down multiplication into smaller steps.</p>

        <h3>How it Works (Example: 23 x 14)</h3>
        <ol>
            <li><strong>Draw the Grid:</strong> Since we are multiplying two 2-digit numbers, draw a 2x2 grid.</li>
            <li><strong>Place the Numbers:</strong> Write the first number (23) along the <strong>top</strong>, one digit above each column (2 above the first, 3 above the second). Write the second number (14) down the <strong>right side</strong>, one digit next to each row (1 next to the top row, 4 next to the bottom row).</li>
            <li><strong>Draw Diagonals:</strong> Draw a diagonal line from the <strong>top-right corner to the bottom-left corner</strong> in each small square of the grid.</li>
            <li><strong>Multiply Digits:</strong> For each small square, multiply the digit directly above it by the digit directly to its right.
                <ul>
                    <li>Top-left square (2x1=02): Write <strong>0</strong> in the top-left (tens) part and <strong>2</strong> in the bottom-right (ones) part.</li>
                    <li>Top-right square (3x1=03): Write <strong>0</strong> in the top-left part, <strong>3</strong> in the bottom-right part.</li>
                    <li>Bottom-left square (2x4=08): Write <strong>0</strong> in the top-left part, <strong>8</strong> in the bottom-right part.</li>
                    <li>Bottom-right square (3x4=12): Write <strong>1</strong> in the top-left part, <strong>2</strong> in the bottom-right part.</li>
                </ul>
            </li>
            <li><strong>Add Diagonally:</strong> Starting from the bottom-right diagonal, add the numbers in each diagonal path. Write the sum below the grid for each path. If a sum is two digits, write the ones digit and carry the tens digit over to the next diagonal (to the left).
                <ul>
                    <li>Bottom-right diagonal: 5. Sum = 5.</li>
                    <li>Middle diagonal: 0 + 1 + 2 = 3. Sum = 3.</li>
                    <li>Next diagonal: 8 + 0 + 1 = 9. Sum = 9.</li>
                    <li>Top-left diagonal: 0. Sum = 0.</li>
                </ul>
            </li>
            <li><strong>Read the Answer:</strong> Read the sums from top-left down to bottom-right: 0935. So, 23 x 45 = 1035. (Wait, the example calculation was slightly off, let's re-do: 8+1+1 = 10 for the third diagonal. Write 0, carry 1. Top diagonal 0+carry 1 = 1. Answer: 1035). Let's use a clearer example in the text: 23 x 14 -> Top-left: 2x1=02, Top-right: 3x1=03, Bottom-left: 2x4=08, Bottom-right: 3x4=12. Diagonals: 2 -> 3+1+8=12 (write 2, carry 1) -> 0+0+2+carry 1=3 -> 0. Answer: 322.</li>
        </ol>
        <p>Let's try with <strong>23 x 14</strong>: Grid has 2, 3 on top; 1, 4 on right. Cells: [0/2, 0/3], [0/8, 1/2]. Diagonals: (bottom-right) 2; (middle) 8+1+3=12 (write 2, carry 1); (next) 0+0+2+carry 1=3; (top-left) 0. Read answer: 0322 = <strong>322</strong>.</p>

        <!-- Static Visual Example -->
        <div style="text-align: center; margin-top: 20px;">
            <strong>Visual Example (23 x 14 = 322):</strong>
            <div class="static-lattice-container">
                <!-- Numbers around the grid -->
                <span class="static-num-top" style="left: 25%;">2</span>
                <span class="static-num-top" style="left: 75%;">3</span>
                <span class="static-num-right" style="top: 25%;">1</span>
                <span class="static-num-right" style="top: 75%;">4</span>

                <!-- The Grid -->
                <div class="static-lattice-grid">
                    <!-- Row 1 -->
                    <div class="static-lattice-cell"> <!-- 2x1=02 -->
                        <span class="static-cell-tens">0</span>
                        <span class="static-cell-ones">2</span>
                    </div>
                    <div class="static-lattice-cell"> <!-- 3x1=03 -->
                        <span class="static-cell-tens">0</span>
                        <span class="static-cell-ones">3</span>
                    </div>
                    <!-- Row 2 -->
                    <div class="static-lattice-cell"> <!-- 2x4=08 -->
                        <span class="static-cell-tens">0</span>
                        <span class="static-cell-ones">8</span>
                    </div>
                    <div class="static-lattice-cell"> <!-- 3x4=12 -->
                        <span class="static-cell-tens">1</span>
                        <span class="static-cell-ones">2</span>
                    </div>
                </div>

                <!-- Diagonal Sums -->
                <span class="static-diag-sum static-diag-sum-0">2</span> <!-- Bottom Right -->
                <span class="static-diag-sum static-diag-sum-1">2</span> <!-- Middle Bottom (from 12) -->
                <span class="static-diag-sum static-diag-sum-2">3</span> <!-- Middle Left (from 3 + carry 1) -->
                <span class="static-diag-sum static-diag-sum-3">0</span> <!-- Top Left -->
            </div>
        </div>
        <!-- End Static Visual Example -->


        <hr style="margin: 30px 0;">

        <h3>üß© Lattice Practice üß©</h3>
        <div id="game-lattice" class="interactive-game" style="background-color: #f9fbe7; border-color: #e6ee9c;">

            <div class="lattice-container">
                <!-- Numbers around the grid (Top and Right) -->
                <span class="lattice-num-top" id="lattice-num1-d1" style="left: 25%;">?</span> <!-- Digit 1 of Num1 -->
                <span class="lattice-num-top" id="lattice-num1-d2" style="left: 75%;">?</span> <!-- Digit 2 of Num1 -->
                <span class="lattice-num-right" id="lattice-num2-d1" style="top: 25%;">?</span> <!-- Digit 1 of Num2 -->
                <span class="lattice-num-right" id="lattice-num2-d2" style="top: 75%;">?</span> <!-- Digit 2 of Num2 -->

                <!-- The Grid (structure remains the same) -->
                <div class="lattice-grid">
                    <!-- Row 1 -->
                    <div class="lattice-cell" id="cell-0-0">
                        <input type="number" class="cell-input-tens" id="cell-0-0-t" min="0" max="9">
                        <input type="number" class="cell-input-ones" id="cell-0-0-o" min="0" max="9">
                    </div>
                    <div class="lattice-cell" id="cell-0-1">
                        <input type="number" class="cell-input-tens" id="cell-0-1-t" min="0" max="9">
                        <input type="number" class="cell-input-ones" id="cell-0-1-o" min="0" max="9">
                    </div>
                    <!-- Row 2 -->
                    <div class="lattice-cell" id="cell-1-0">
                        <input type="number" class="cell-input-tens" id="cell-1-0-t" min="0" max="9">
                        <input type="number" class="cell-input-ones" id="cell-1-0-o" min="0" max="9">
                    </div>
                    <div class="lattice-cell" id="cell-1-1">
                        <input type="number" class="cell-input-tens" id="cell-1-1-t" min="0" max="9">
                        <input type="number" class="cell-input-ones" id="cell-1-1-o" min="0" max="9">
                    </div>
                </div>

                <!-- Diagonal Sum Inputs -->
                <input type="number" class="diagonal-sum-input" id="diag-sum-0" placeholder="Sum"> <!-- Bottom Right -->
                <input type="number" class="diagonal-sum-input" id="diag-sum-1" placeholder="Sum">
                <input type="number" class="diagonal-sum-input" id="diag-sum-2" placeholder="Sum">
                <input type="number" class="diagonal-sum-input" id="diag-sum-3" placeholder="Sum"> <!-- Top Left -->
            </div>

            <div class="final-answer-lattice">
                <label for="final-answer-lattice">Final Answer:</label>
                <input type="number" id="final-answer-lattice" placeholder="Read from sums">
            </div>

            <div style="margin-top: 20px;">
                <button id="check-lattice-button" class="game-button" style="background-color: #c0ca33;">Check Answer</button>
                <button id="new-lattice-button" class="game-button" style="background-color: #9e9d24;">New Problem</button>
            </div>
            <p id="feedback-lattice" class="feedback-message"></p>

            <!-- Hint Section -->
            <div class="hint-controls" style="margin-top: 20px;">
                 <button id="show-hint-lattice-button" class="game-button" style="background-color: #4caf50;">üí° Show Hint</button>
                 <button id="prev-hint-lattice-button" class="game-button" style="background-color: #ff9800; display: none;">&lt; Prev Step</button>
                 <button id="next-hint-lattice-button" class="game-button" style="background-color: #ff9800; display: none;">Next Step &gt;</button>
            </div>
            <div id="hint-area-lattice" class="hint-area" style="display: none;">
                <p id="hint-text-lattice">Hint will appear here.</p>
            </div>
        </div>

    </main>

    <footer>
        <p>üöÄ Keep Practicing! üöÄ</p>
    </footer>

    <!-- Load main script FIRST -->
    <script src="../js/script.js"></script>
    <!-- Load page-specific script -->
    <script src="../js/lattice.js"></script>
</body>
</html>
